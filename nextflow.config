//global params
workDir = "/home/jsmi26/temp" 
params {
    // general options
    //validate_params           = true // will add in the sample sheet validation
    outdir                      = "./results/"
    publish_dir_mode            = 'copy'
    enable_conda                = true

    //global params
    sample_sheet                = "test_data/sample_sheet.txt"

    //star specific params
    //Must be full filepaths for files outside the projectDir
    index                       = "/gpfs/shared_data/STAR/human_v38/STAR_2.7"
    gtf                         = "/gpfs/shared_data/STAR/human_v38/STAR_2.7/genes.gtf"
    fasta                       = "/gpfs/shared_data/STAR/human_v38/STAR_2.7/genome.fa"
    star_ignore_sjdbgtf         = false
    seq_platform                = ''
    seq_center                  = ''
}

// Run the analysis on Cybertron interactive node with minimal compute resources
process {
    executor = 'local'
    publishDir = [
        path: { "${params.outdir}/${task.process.tokenize(':')[-1].tokenize('_')[0].toLowerCase()}" },
        mode: params.publish_dir_mode,
        saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
    ]
    errorStrategy = "retry"
    maxRetries = 1

    //FastQC process specific parameters
    withName: FASTQC {
        cpus = 1
        memory = 4.GB
        ext.args = '--quiet'
    }

    //STAR-aligner process specific parameters
    withName: STAR_ALIGN {
        cpus = 5
        memory = 32.GB
        ext.args = '--readFilesCommand "gunzip -c" --outSAMattributes NH HI NM MD AS nM jM jI XS --quantMode GeneCounts'
    }

    //STAR index process specific parameters
    withName: STAR_GENOMEGENERATE {
        cpus = 6
        memory = 64.GB
        ext.args = ''
    }
}

/*
//Use singularity containers 
singularity {
    enabled = true
    autoMounts = true
    cacheDir = '/home/jsmi26/temp'
    runOptions = '--containall --no-home'
}
*/

/*
//Use docker engine for local Macbook ONLY
docker {
    enabled = true
    temp = 'auto'
    runOptions = "--platform linux/amd64 --memory=32g --cpus=0.000"
}
*/
